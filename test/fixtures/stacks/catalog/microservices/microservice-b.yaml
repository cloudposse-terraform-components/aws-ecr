imports:
  - catalog/usecase/basic

components:
  terraform:
    ecr/microservice-b:
      metadata:
        component: ecr
        inherits:
          - ecr/basic
      vars:
        repository_name: microservice-b
        name: ecr-microservice-b
        lifecycle_rules:
          - priority: 1
            description: "only keep 10 images"
            selection:
              tag_status: tagged
              tag_prefix_list: ["prod"]
              count_type: imageCountMoreThan
              count_number: 10
            action:
              type: expire
          - priority: 10
            description: "dev 10 rule"
            selection:
              tag_status: tagged
              tag_prefix_list: ["dev"]
              count_type: imageCountMoreThan
              count_number: 10
            action:
              type: expire
          - priority: 15
            description: "dev 10 rule"
            selection:
              tag_status: tagged
              tag_pattern_list: ["dev-*"]
              count_type: imageCountMoreThan
              count_number: 10
            action:
              type: expire
          - priority: 20
            description: "default rule"
            selection:
              tag_status: untagged
              count_type: imageCountMoreThan
              count_number: 10
            action:
              type: expire
          - priority: 40
            description: "Any tag rule"
            selection:
              tag_status: any
              count_type: sinceImagePushed
              count_unit: days
              count_number: 10
            action:
              type: expire